{% extends "base.html" %}

{% block title %}RSVP Status - {{ event.title }} - Digital Club{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow-lg border-0">
                <div class="card-header text-center py-4">
                    {% if rsvp.status == 'approved' %}
                        <div class="bg-success text-white">
                            <h2 class="mb-0">
                                <i class="fas fa-check-circle me-2"></i>
                                RSVP Approved!
                            </h2>
                        </div>
                    {% elif rsvp.status == 'rejected' %}
                        <div class="bg-danger text-white">
                            <h2 class="mb-0">
                                <i class="fas fa-times-circle me-2"></i>
                                RSVP Not Approved
                            </h2>
                        </div>
                    {% else %}
                        <div class="bg-warning text-dark">
                            <h2 class="mb-0">
                                <i class="fas fa-clock me-2"></i>
                                RSVP Pending Review
                            </h2>
                        </div>
                    {% endif %}
                </div>
                
                <div class="card-body p-5">
                    <!-- Event Information -->
                    <div class="event-info mb-4 p-4 bg-light rounded">
                        <h4 class="text-primary mb-3">
                            <i class="fas fa-calendar-alt me-2"></i>
                            {{ event.title }}
                        </h4>
                        <div class="row">
                            <div class="col-md-6">
                                <p class="mb-2">
                                    <i class="fas fa-clock me-2"></i>
                                    <strong>Date & Time:</strong><br>
                                    {{ event.event_date.strftime('%B %d, %Y at %I:%M %p') }}
                                </p>
                            </div>
                            <div class="col-md-6">
                                <p class="mb-2">
                                    <i class="fas fa-map-marker-alt me-2"></i>
                                    <strong>Location:</strong><br>
                                    {{ event.location or 'TBA' }}
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- RSVP Details -->
                    <div class="rsvp-details mb-4">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-user me-2"></i>
                            Your RSVP Details
                        </h5>
                        
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <strong>Name:</strong> {{ rsvp.full_name }}
                                {% if not rsvp.member_id or rsvp.member_id == 0 %}
                                <span class="badge bg-secondary ms-2">Non-Member</span>
                                {% endif %}
                            </div>
                            <div class="col-md-6 mb-3">
                                <strong>Email:</strong> {{ rsvp.email }}
                            </div>
                            {% if rsvp.phone %}
                            <div class="col-md-6 mb-3">
                                <strong>Phone:</strong> {{ rsvp.phone }}
                            </div>
                            {% endif %}
                            {% if rsvp.course %}
                            <div class="col-md-6 mb-3">
                                <strong>Course:</strong> {{ rsvp.course }}
                            </div>
                            {% endif %}
                            {% if rsvp.year %}
                            <div class="col-md-6 mb-3">
                                <strong>Year:</strong> {{ rsvp.year }}
                            </div>
                            {% endif %}
                            <div class="col-md-6 mb-3">
                                <strong>Submitted:</strong> {{ rsvp.submitted_at.strftime('%B %d, %Y at %I:%M %p') }}
                            </div>
                        </div>
                    </div>

                    <!-- Status Specific Information -->
                    {% if rsvp.status == 'approved' %}
                        <div class="alert alert-success" role="alert">
                            <h5 class="alert-heading">
                                <i class="fas fa-check-circle me-2"></i>
                                Congratulations! Your RSVP has been approved.
                            </h5>
                            <hr>
                            <div class="row">
                                <div class="col-md-6">
                                    <p class="mb-2">
                                        <strong>Acceptance Code:</strong><br>
                                        <span class="h4 text-success">{{ rsvp.acceptance_code }}</span>
                                    </p>
                                </div>
                                <div class="col-md-6">
                                    <p class="mb-2">
                                        <strong>Approved On:</strong><br>
                                        {{ rsvp.approved_at.strftime('%B %d, %Y at %I:%M %p') }}
                                    </p>
                                </div>
                            </div>
                            <hr>
                            <p class="mb-0">
                                <strong>Important:</strong> Please bring this acceptance code with you to the event for verification. 
                                You should have also received this information via email/SMS.
                            </p>
                        </div>
                        
                        <!-- Print Button -->
                        <div class="text-center mb-4">
                            <button onclick="window.print()" class="btn btn-outline-primary">
                                <i class="fas fa-print me-2"></i>
                                Print This Page
                            </button>
                        </div>
                        
                    {% elif rsvp.status == 'rejected' %}
                        <div class="alert alert-danger" role="alert">
                            <h5 class="alert-heading">
                                <i class="fas fa-times-circle me-2"></i>
                                RSVP Not Approved
                            </h5>
                            <hr>
                            <p class="mb-2">
                                <strong>Rejected On:</strong> {{ rsvp.approved_at.strftime('%B %d, %Y at %I:%M %p') }}
                            </p>
                            <p class="mb-0">
                                Unfortunately, we are unable to accommodate your RSVP at this time due to capacity limitations. 
                                We appreciate your understanding and hope to see you at future events.
                            </p>
                        </div>
                        
                    {% else %}
                        <div class="alert alert-warning" role="alert">
                            <h5 class="alert-heading">
                                <i class="fas fa-clock me-2"></i>
                                RSVP Under Review
                            </h5>
                            <hr>
                            <p class="mb-0">
                                Your RSVP is currently being reviewed by our admin team. You will receive an email/SMS notification 
                                once a decision has been made. Please check back later or contact us if you have any questions.
                            </p>
                        </div>
                    {% endif %}

                    <!-- Additional Information -->
                    {% if rsvp.dietary_requirements or rsvp.emergency_contact or rsvp.additional_notes %}
                    <div class="additional-info mt-4">
                        <h5 class="text-primary mb-3">
                            <i class="fas fa-info-circle me-2"></i>
                            Additional Information
                        </h5>
                        
                        {% if rsvp.dietary_requirements %}
                        <div class="mb-3">
                            <strong>Dietary Requirements:</strong><br>
                            {{ rsvp.dietary_requirements }}
                        </div>
                        {% endif %}
                        
                        {% if rsvp.emergency_contact %}
                        <div class="mb-3">
                            <strong>Emergency Contact:</strong><br>
                            {{ rsvp.emergency_contact }}
                            {% if rsvp.emergency_phone %} - {{ rsvp.emergency_phone }}{% endif %}
                        </div>
                        {% endif %}
                        
                        {% if rsvp.additional_notes %}
                        <div class="mb-3">
                            <strong>Additional Notes:</strong><br>
                            {{ rsvp.additional_notes }}
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}

                    <!-- Action Buttons -->
                    <div class="text-center mt-4">
                        <a href="{{ url_for('main.events') }}" class="btn btn-outline-primary me-3">
                            <i class="fas fa-calendar me-2"></i>
                            View All Events
                        </a>
                        {% if rsvp.status == 'pending' %}
                        <a href="{{ url_for('main.event_rsvp', event_id=event.id) }}" class="btn btn-primary">
                            <i class="fas fa-edit me-2"></i>
                            Update RSVP
                        </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
@media print {
    .btn, .alert-warning, .alert-danger {
        display: none !important;
    }
    .alert-success {
        border: 2px solid #28a745 !important;
        background-color: #d4edda !important;
    }
}
</style>
{% endblock %}
